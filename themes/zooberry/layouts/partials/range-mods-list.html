{{ $tag := .tag }}
{{ $context := .context }}


{{ $mods := where $context.Site.RegularPages "Section" "mods" }}
{{ $filteredMods := where $mods "Params.tags" "intersect" (slice "objects") }}
{{ $sortedMods := sort $filteredMods "Title" "asc" }}
{{ $paginator := $context.Paginate $sortedMods }}
{{ template "_internal/pagination.html" (dict "paginator" $paginator "page" $context) }}

<div class="box-card-list">
    {{ range $paginator.Pages }}
    {{ if in .Params.tags $tag }}
    <li class="box-card-mods">
        <div class="box-card-mods-img">
            {{/*  get first image from images folder in this bundle */}}
            {{ $thumbnail := "" }}
            {{ with (.Resources.GetMatch "images/*") }}
                {{ $processedImage := .Fill "300x200 center" }} <!-- Adjust dimensions as needed -->
                {{ $thumbnail = $processedImage.RelPermalink }}
            {{ end }}

            <a href="{{ .RelPermalink }}">
                <img src="{{ $thumbnail }}" alt="{{ .LinkTitle }}">
            </a>
        </div>
        <div class="box-card-mods-content">
                <p>
                {{ if eq .Params.game "Zoo Tycoon 1" }}
                    <a href="mods/zt1">{{ .Params.game }}</a>
                {{ else if eq .Params.game "Zoo Tycoon 2" }}
                    <a href="mods/zt2">{{ .Params.game }}</a>
                {{ else }}
                    {{ .Params.game }}
                {{ end }}
                </p>
            <h2><a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a></h2>
            <p><i class="material-icons icon">person</i>  
                {{ $authors := .Params.author }}

                {{ $len := len $authors }}
                {{ if eq $len 1 }}
                    {{ index $authors 0 }}
                {{ else if eq $len 2 }}
                    {{ index $authors 0 }} and {{ index $authors 1 }}
                {{ else }}
                    {{ index $authors 0 }}, {{ index $authors 1 }}, and {{ add $len -2 }} more
                {{ end }}
            </p>
            <span class="box-card-bottom">
                {{ partial "class-badges.html" . }}
                <span class="box-card-date">{{ .Date.Format "2 Jan 2006" }}</span>
            </span>
        </div>
    </li>
    {{ end }}
        {{ end }}
  </div>
  {{ template "_internal/pagination.html" (dict "paginator" $paginator "page" $context) }}
</div>
