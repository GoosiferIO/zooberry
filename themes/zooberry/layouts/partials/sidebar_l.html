<div class="sidebar">
    {{/*  ZooBerry logo  */}}
    <a href="/" title="ZooBerry" class="nav-logo"></a>

    {{/*  Main menu  */}}
    <ul class="side-ul main-menu sidebar-open">
        <li class="side-kofi">
            <script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script>
            <script type='text/javascript'>
                kofiwidget2.init('Support Us on Ko-fi', 'var(--kofi)', 'U7U6UXNXD');
                kofiwidget2.draw();
            </script>
        </li>
    
        {{/*  Grabs main menu from hugo.toml  */}}
        {{- with index site.Menus "main" }}
    {{ range . }}
        {{ if .HasChildren }}
            <li class="side-li has-children">
                <a class="dropbtn" href="#"><i class="material-icons icon pre-anim">{{ .Params.icon }}</i>{{ .Name }}<i class="material-icons icon arrow">arrow_forward_ios</i></a>
                <ul class="submenu">
                    {{ range .Children }}
                        <li><a href="{{ .PageRef }}">{{ .Name }}</a></li>
                    {{ end }}
                </ul>
            </li>
        {{ else }}
            <li class="side-li">
                <a href="{{ .PageRef }}"><i class="material-icons icon pre-anim">{{ .Params.icon }}</i> {{ .Name }}</a>
            </li>
            {{- end }}
        {{ end }}
    {{- end }}

    </ul>


    {{/* Menu that goes below the main. Simple filtering options. */}}
    <ul class="side-ul filter-menu sidebar-open">
        <li class="side-li"><a class="dropbtn" href="/latest"><i class="material-icons icon">arrow_forward</i> Latest Mods</a></li>
        <li class="side-li"><a class="dropbtn" href="/author"><i class="material-icons icon">groups</i> Author List</a></li>
        <li class="side-li"><a class="dropbtn" href="/archived-website"><i class="material-icons icon">archive</i> Archived Websites</a></li>
        <li class="side-li"><a class="dropbtn" href="/team"><i class="material-icons icon">design_services</i> Design Teams</a></li>
    </ul>

    {{/*  Theme switcher  */}}
    <label class="switch">
        <input type="checkbox" id="theme-switcher">
        <div class="slider round"></div>
    </label>

    {{/*  Theme switch script  */}}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const themeSwitcher = document.getElementById('theme-switcher');
          
            // Load saved theme preference
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
              document.body.classList.add('dark');
              themeSwitcher.checked = true;
            }
          
            // Detect OS preference if no saved preference
            else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
              document.body.classList.add('dark');
              themeSwitcher.checked = true;
            }
          
            // Handle toggle switch
            themeSwitcher.addEventListener('change', function() {
              document.body.classList.toggle('dark');
              localStorage.setItem('theme', this.checked ? 'dark' : 'light');
            });
          });
    </script>

    {{/*  Sliding door navigation script  */}}
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const menuLinks = document.querySelectorAll('.side-li.has-children > .dropbtn');
            const mainMenu = document.querySelector('.side-ul.main-menu');
        
            menuLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault(); // Prevent navigation
        
                    const submenu = this.nextElementSibling;
        
                    if (submenu && submenu.classList.contains('submenu')) {
                        // Close all other submenus
                        document.querySelectorAll('.submenu').forEach(sub => {
                            if (sub !== submenu) {
                                sub.classList.remove('submenu-open');
                                sub.style.maxHeight = null;
                            }
                        });
        
                        // Toggle the submenu
                        if (!submenu.classList.contains('submenu-open')) {
                            submenu.classList.add('submenu-open');
                            mainMenu.classList.add('menu-slid'); // Slide main menu out
                            submenu.style.maxHeight = submenu.scrollHeight + 'px';
                        } else {
                            submenu.classList.remove('submenu-open');
                            mainMenu.classList.remove('menu-slid'); // Slide main menu back in
                            submenu.style.maxHeight = null;
                        }
                    }
                });
            });
        });
        </script>
</div>
