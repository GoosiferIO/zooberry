<div class="sidebar">
    {{/*  ZooBerry logo  */}}
    <a href="/" title="ZooBerry" class="nav-logo"></a>

    {{/*  Main menu  */}}
    <ul class="side-ul main-menu">
        <li class="side-kofi"><script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Support Us on Ko-fi', 'var(--kofi)', 'U7U6UXNXD');kofiwidget2.draw();</script></li>
        
        {{/*  Grabs main menu from hugo.toml  */}}
        {{- with index site.Menus "main" }}
            {{ range . }}
                <li class="side-li">
                    {{ if .HasChildren }}
                    <a class="dropbtn" href="{{ .PageRef }}"><i class="material-icons icon">{{ .Params.icon }}</i>{{ .Name }}<i class="material-icons icon">expand_more</i></a>
                        <ul class="submenu">
                            {{ range .Children }}
                                <li><a href="{{ .PageRef }}">{{ .Name }}</a></li>
                            {{ end }}
                        </ul>
                    {{ else }}
                        <a href="{{ .PageRef }}"><i class="material-icons icon">{{ .Params.icon }}</i> {{ .Name }}</a>
                    {{- end }}    
                </li>
            {{ end }}
        {{- end }}
    </ul>

    {{/* Menu that goes below the main. Simple filtering options. */}}
    <ul class="side-ul filter-menu">
        <li class="side-li"><a class="dropbtn" href="/mods/zt1"><i class="material-icons icon">arrow_forward</i> Latest Mods</a></li>
        <li class="side-li"><a class="dropbtn" href="/mods/zt2"><i class="material-icons icon">groups</i> Author List</a></li>
        <li class="side-li"><a class="dropbtn" href="/mods/zt1"><i class="material-icons icon">archive</i> Archived Websites</a></li>
        <li class="side-li"><a class="dropbtn" href="/mods/zt2"><i class="material-icons icon">design_services</i> Design Teams</a></li>
    </ul>

    {{/*  Theme switcher  */}}
    <label class="switch">
        <input type="checkbox" id="theme-switcher">
        <div class="slider round"></div>
    </label>

    {{/*  Theme switch script  */}}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const themeSwitcher = document.getElementById('theme-switcher');
          
            // Load saved theme preference
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
              document.body.classList.add('dark');
              themeSwitcher.checked = true;
            }
          
            // Detect OS preference if no saved preference
            else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
              document.body.classList.add('dark');
              themeSwitcher.checked = true;
            }
          
            // Handle toggle switch
            themeSwitcher.addEventListener('change', function() {
              document.body.classList.toggle('dark');
              localStorage.setItem('theme', this.checked ? 'dark' : 'light');
            });
          });
    </script>

    {{/*  Sliding door navigation script  */}}
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const menuLinks = document.querySelectorAll('.dropbtn');
        
            menuLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    const submenu = this.nextElementSibling;
        
                    // Check if the submenu exists
                    if (submenu && submenu.classList.contains('submenu')) {
                        e.preventDefault();
        
                        // Close all other submenus
                        document.querySelectorAll('.submenu').forEach(sub => {
                            if (sub !== submenu) {
                                sub.classList.remove('submenu-open');
                                sub.style.maxHeight = null;
                            }
                        });
        
                        // Toggle the clicked submenu
                        submenu.classList.toggle('submenu-open');
                        if (submenu.classList.contains('submenu-open')) {
                            submenu.style.maxHeight = submenu.scrollHeight + 'px';
                        } else {
                            submenu.style.maxHeight = null;
                        }
                    }
                    // If there's no submenu, the link will function normally
                });
            });
        });
        
    </script>
</div>
